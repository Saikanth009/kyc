<div class="wrap" *ngIf="me; else loading">
  <!-- Header -->
  <div class="header">
    <div class="header-left">
      <div class="logo">
        <span class="shield-icon">ğŸ›¡ï¸</span>
        <span class="logo-text">KYC Portal</span>
      </div>
    </div>
    <button class="logout-btn" (click)="logout()">
      <span class="logout-icon">â†’</span>
      Logout
    </button>
  </div>

  <!-- Welcome Section -->
  <div class="welcome-section">
    <h1 class="welcome-title">Welcome, {{ me.name }}!</h1>
    <p class="welcome-subtitle">Manage your KYC verification status and details</p>
  </div>

  <!-- KYC Verification Status Card -->
  <div class="card">
    <div class="card-header status-header">
      <span class="header-title">KYC Verification Status</span>
      <span class="status-badge" [class]="getStatusClass(me.status || 'Pending')">
        <span class="clock-icon">ğŸ•</span>
        {{ me.status || 'Pending' }}
      </span>
    </div>
    <div class="card-body">
      <div class="status-message" *ngIf="me.status === 'Pending'">
        Your KYC application is under review. We will notify you once it is processed.
      </div>
      <div class="status-message approved" *ngIf="me.status === 'Approved'">
        Your KYC has been approved. You now have full access.
      </div>
      <div class="status-message rejected" *ngIf="me.status === 'Rejected'">
        Your KYC has been rejected. Please re-upload correct documents.
      </div>
    </div>
  </div>

  <!-- Personal Information Card -->
  <div class="card">
    <div class="card-header">
      <span class="header-title">Personal Information</span>
    </div>
    <div class="card-body">
      <div class="info-grid">
        <div class="info-item">
          <div class="info-icon">ğŸ‘¤</div>
          <div class="info-content">
            <div class="info-label">Full Name</div>
            <div class="info-value">{{ me.name }}</div>
          </div>
        </div>
        <div class="info-item">
          <div class="info-icon">ğŸ“</div>
          <div class="info-content">
            <div class="info-label">Phone Number</div>
            <div class="info-value">{{ me.phone }}</div>
          </div>
        </div>
        <div class="info-item">
          <div class="info-icon">âœ‰ï¸</div>
          <div class="info-content">
            <div class="info-label">Email Address</div>
            <div class="info-value">{{ me.email }}</div>
          </div>
        </div>
        <div class="info-item">
          <div class="info-icon">ğŸ“</div>
          <div class="info-content">
            <div class="info-label">Address</div>
            <div class="info-value">{{ me.address }}</div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- KYC Documents Card -->
  <div class="card">
    <div class="card-header">
      <span class="header-title">KYC Documents</span>
    </div>
    <div class="card-body">
      <!-- Document Numbers Row -->
      <div class="doc-numbers-row">
        <div class="doc-number-item">
          <div class="doc-icon">ğŸ“„</div>
          <div class="doc-content">
            <div class="doc-label">Aadhaar Number</div>
            <div class="doc-value">{{ me.aadhaar || 'Not provided' }}</div>
          </div>
        </div>
        <div class="doc-number-item">
          <div class="doc-icon">ğŸ“„</div>
          <div class="doc-content">
            <div class="doc-label">PAN Number</div>
            <div class="doc-value">{{ me.pan || 'Not provided' }}</div>
          </div>
        </div>
      </div>

      <!-- Uploaded Images Row -->
      <div class="doc-images-row">
        <!-- Aadhaar Document -->
        <div class="doc-image-item">
          <div class="doc-image-title">Aadhaar Document</div>
          <div class="doc-image-container">
            <ng-container *ngIf="me.documents?.aadhaar; else noAadhaar">
              <img [src]="baseUrl + '/uploads/' + me.documents.aadhaar + '?t=' + cacheBust" 
                   class="doc-image" 
                   (click)="openFile(baseUrl + '/uploads/' + me.documents.aadhaar + '?t=' + cacheBust)" />
            </ng-container>
            <ng-template #noAadhaar>
              <div class="no-image">No image uploaded</div>
            </ng-template>
          </div>
          <div class="doc-actions">
            <button class="action-btn delete-btn" (click)="deleteDocument('aadhaar')" title="Delete">
              ğŸ—‘ï¸ Delete
            </button>
            <button class="action-btn upload-btn" (click)="triggerFileUpload('aadhaar')" title="Upload">
              ğŸ“¤ Upload
            </button>
          </div>
        </div>

        <!-- PAN Document -->
        <div class="doc-image-item">
          <div class="doc-image-title">PAN Document</div>
          <div class="doc-image-container">
            <ng-container *ngIf="me.documents?.pan; else noPan">
              <img [src]="baseUrl + '/uploads/' + me.documents.pan + '?t=' + cacheBust" 
                   class="doc-image" 
                   (click)="openFile(baseUrl + '/uploads/' + me.documents.pan + '?t=' + cacheBust)" />
            </ng-container>
            <ng-template #noPan>
              <div class="no-image">No image uploaded</div>
            </ng-template>
          </div>
          <div class="doc-actions">
            <button class="action-btn delete-btn" (click)="deleteDocument('pan')" title="Delete">
              ğŸ—‘ï¸ Delete
            </button>
            <button class="action-btn upload-btn" (click)="triggerFileUpload('pan')" title="Upload">
              ğŸ“¤ Upload
            </button>
          </div>
        </div>

        <!-- Photograph -->
        <div class="doc-image-item">
          <div class="doc-image-title">Photograph</div>
          <div class="doc-image-container">
            <ng-container *ngIf="me.documents?.photo; else noPhoto">
              <img [src]="baseUrl + '/uploads/' + me.documents.photo + '?t=' + cacheBust" 
                   class="doc-image" 
                   (click)="openFile(baseUrl + '/uploads/' + me.documents.photo + '?t=' + cacheBust)" />
            </ng-container>
            <ng-template #noPhoto>
              <div class="no-image">No image uploaded</div>
            </ng-template>
          </div>
          <div class="doc-actions">
            <button class="action-btn delete-btn" (click)="deleteDocument('photo')" title="Delete">
              ğŸ—‘ï¸ Delete
            </button>
            <button class="action-btn upload-btn" (click)="triggerFileUpload('photo')" title="Upload">
              ğŸ“¤ Upload
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Hidden file inputs for individual uploads -->
  <input #aadhaarInput type="file" accept="image/*" (change)="uploadSingleDocument('aadhaar', $event)" style="display: none;" />
  <input #panInput type="file" accept="image/*" (change)="uploadSingleDocument('pan', $event)" style="display: none;" />
  <input #photoInput type="file" accept="image/*" (change)="uploadSingleDocument('photo', $event)" style="display: none;" />
  
  <!-- Success/Error Messages -->
  <div *ngIf="successMessage" class="success-message">
    {{ successMessage }}
  </div>
  <div *ngIf="uploadError" class="error-message">
    {{ uploadError }}
  </div>
</div>
<ng-template #loading>Loading...</ng-template>
<div *ngIf="error">{{ error }}</div>
